(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(1),a=n.n(c),i=n(17),s=n.n(i),u=n(4),o=n.n(u),l=n(6),b=n(8),d=n(2),j=function(e){var t=e.blog,n=e.user,a=e.updateLikes,i=e.deleteBlog,s=Object(c.useState)(!0),u=Object(d.a)(s,2),o=u[0],l=u[1];return Object(r.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blogRender",children:[t.title," ",t.author," ",t.url," ",Object(r.jsx)("button",{className:"viewHide",onClick:function(){l(!o)},children:o?"view":"hide"}),!1===o&&Object(r.jsxs)("div",{className:"blog",children:[t.url,Object(r.jsx)("br",{}),"likes ",t.likes," ",Object(r.jsx)("button",{className:"likesButton",onClick:a,children:"like"}),Object(r.jsx)("br",{}),n.name,Object(r.jsx)("br",{}),t.user.username===n.username&&Object(r.jsx)("button",{onClick:i,children:"remove"})]})]})},O=n(5),h=n.n(O),f="/api/blogs",g=null,p={getAll:function(){return h.a.get(f).then((function(e){return e.data}))},setToken:function(e){g="bearer ".concat(e)},create:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,h.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return h.a.put("".concat(f,"/").concat(e),t).then((function(e){return e.data}))},deleteBlog:function(e){var t={headers:{Authorization:g}};return h.a.delete("".concat(f,"/").concat(e),t).then((function(e){return e.data}))}},v={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(e){var t=e.status,n=e.message;return null===n?null:Object(r.jsx)("div",{className:t,children:n})},m=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,c=e.handlePasswordChange,a=e.username,i=e.password;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Login"}),Object(r.jsxs)("form",{onSubmit:t,children:[Object(r.jsxs)("div",{children:["username",Object(r.jsx)("input",{id:"username",value:a,onChange:n})]}),Object(r.jsxs)("div",{children:["password",Object(r.jsx)("input",{id:"password",type:"password",value:i,onChange:c})]}),Object(r.jsx)("button",{id:"login-button",type:"submit",children:"login"})]})]})},k=function(e){var t=e.createBlog,n=Object(c.useState)(""),a=Object(d.a)(n,2),i=a[0],s=a[1],u=Object(c.useState)(""),o=Object(d.a)(u,2),l=o[0],b=o[1],j=Object(c.useState)(""),O=Object(d.a)(j,2),h=O[0],f=O[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Create a new blog"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:i,author:l,url:h}),s(""),b(""),f("")},children:[Object(r.jsxs)("label",{children:["title:",Object(r.jsx)("input",{id:"title",value:i,onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(r.jsx)("br",{}),Object(r.jsxs)("label",{children:["author:",Object(r.jsx)("input",{id:"author",value:l,onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(r.jsx)("br",{}),Object(r.jsxs)("label",{children:["url:",Object(r.jsx)("input",{id:"url",value:h,onChange:function(e){var t=e.target;return f(t.value)}})]}),Object(r.jsx)("br",{}),Object(r.jsx)("button",{type:"submit",children:"create"})]})]})},w=a.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),a=Object(d.a)(n,2),i=a[0],s=a[1],u={display:i?"none":""},o={display:i?"":"none"},l=function(){s(!i)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:u,children:Object(r.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(r.jsxs)("div",{style:o,children:[e.children,Object(r.jsx)("button",{onClick:l,children:"cancel"})]})]})}));w.displayName="Togglable";var y=w,S=function(){var e=Object(c.useState)([]),t=Object(d.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(null),s=Object(d.a)(i,2),u=s[0],O=s[1],h=Object(c.useState)(null),f=Object(d.a)(h,2),g=f[0],w=f[1],S=Object(c.useState)(""),C=Object(d.a)(S,2),B=C[0],N=C[1],T=Object(c.useState)(""),L=Object(d.a)(T,2),I=L[0],U=L[1],A=Object(c.useState)(null),J=Object(d.a)(A,2),E=J[0],R=J[1],z=Object(c.useState)(!1),D=Object(d.a)(z,2),H=D[0],P=D[1];Object(c.useEffect)((function(){p.getAll().then((function(e){return a(e)}))}),[]),Object(c.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);R(t),p.setToken(t.token)}}),[]);var V=Object(c.useRef)(),W=function(e){V.current.toggleVisibility(),p.create(e).then((function(e){a(n.concat(e)),w("success"),O("".concat(e.title," by ").concat(e.author," added")),setTimeout((function(){O(null)}),5e3)}))},q=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v.login({username:B,password:I});case 4:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),p.setToken(n.token),R(n),N(""),U(""),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),w("error"),O("Wrong username or password"),setTimeout((function(){O(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),F=n.sort((function(e,t){return t.likes-e.likes}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"blogs"}),Object(r.jsx)(x,{status:g,message:u}),null===E?function(){var e={display:H?"none":""},t={display:H?"":"none"};return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:e,children:Object(r.jsx)("button",{onClick:function(){return P(!0)},children:"log in"})}),Object(r.jsxs)("div",{style:t,children:[Object(r.jsx)(m,{username:B,password:I,handleUsernameChange:function(e){var t=e.target;return N(t.value)},handlePasswordChange:function(e){var t=e.target;return U(t.value)},handleSubmit:q}),Object(r.jsx)("button",{onClick:function(){return P(!1)},children:"cancel"})]})]})}():Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:[E.name," logged in",Object(r.jsx)("button",{onClick:function(){return window.localStorage.removeItem("loggedBlogappUser"),R(null),N(""),void U("")},children:"logout"})]}),Object(r.jsx)(y,{buttonLabel:"create blog",ref:V,children:Object(r.jsx)(k,{createBlog:W})}),F.map((function(e){return Object(r.jsx)(j,{blog:e,user:E,updateLikes:function(){!function(e){var t=n.find((function(t){return t.id===e})),r=Object(b.a)(Object(b.a)({},t),{},{likes:t.likes+=1});p.update(e,r).then((function(t){a(n.map((function(n){return n.id!==e?n:t})))}))}(e.id)},deleteBlog:function(){!function(e){var t=n.find((function(t){return t.id===e}));window.confirm("remove blog ".concat(t.title," by ").concat(t.author))&&p.deleteBlog(e).then((function(){a(n.filter((function(t){return t.id!==e})))}))}(e.id)}},e.id)}))]})]})};s.a.render(Object(r.jsx)(S,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.0f54f0aa.chunk.js.map